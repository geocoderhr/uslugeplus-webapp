<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>UslugePlus</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --main-color: #3390ec; }
        body { font-family: sans-serif; background: var(--tg-theme-bg-color); color: var(--tg-theme-text-color); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .hidden { display: none; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid var(--main-color); border-radius: 50%; width: 30px; height: 30px; animation: spin 2s linear infinite; margin-top: 50px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; margin-top: 20px; }
        .menu-item { background: var(--tg-theme-secondary-bg-color); padding: 20px; border-radius: 12px; text-align: center; cursor: pointer; border: 1px solid rgba(0,0,0,0.1); font-weight: bold; }
    </style>
</head>
<body>

    <div id="loading-screen">
        <div class="loader"></div>
        <p>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è...</p>
    </div>

    <div id="main-menu" class="hidden">
        <h3>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</h3>
        <div class="menu-grid">
            <div class="menu-item" onclick="action('create_request')">üìù –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É</div>
            <div class="menu-item" onclick="action('be_provider')">üõ† –Ø –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</div>
            <div class="menu-item" onclick="action('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</div>
            <div class="menu-item" onclick="action('referral')">üéÅ –ë–æ–Ω—É—Å—ã</div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        async function init() {
            try {
                // –í—ã–∑—ã–≤–∞–µ–º —Ç–≤–æ–π API –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 
                const response = await fetch('https://api.uslugeplus.com/auth/telegram', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ initData: tg.initData })
                });

                const data = await response.json();

                if (data.ok) {
                    document.getElementById('loading-screen').classList.add('hidden');
                    document.getElementById('main-menu').classList.remove('hidden');
                    console.log("User authorized:", data.user);
                } else {
                    alert("–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.");
                }
            } catch (e) {
                alert("–û—à–∏–±–∫–∞ —Å–≤—è–∑–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º");
            }
        }

        function action(type) {
            tg.HapticFeedback.impactOccurred('light');
            alert("–í—ã–±—Ä–∞–Ω–æ: " + type + ". –°–∫–æ—Ä–æ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ n8n!");
        }

        init();
    </script>
</body>
</html>
